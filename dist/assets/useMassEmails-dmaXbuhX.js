import{u as h,b as v,c as o}from"./query-BgC-0ePs.js";import{m as r}from"./massEmails-cdFsY1gu.js";import{u as E}from"./index-laD0T8Yw.js";import{u as d}from"./useEffectiveOwner-BN9vJCNM.js";function f(e=!1){const{ownerIds:t,filterKey:s}=d();return h({queryKey:["roleUserIds",s,e],queryFn:async()=>!e||t.length>1?t:E.getUserIdsByRole(t[0]),enabled:t.length>0,staleTime:6e4})}function K(e={}){const{ownerIds:t,filterKey:s}=d();return h({queryKey:["massEmails",s,"withStats",e],queryFn:()=>r.getAllWithStats(t,e),enabled:t.length>0})}function g(e,t={}){const{ownerIds:s,filterKey:n}=d();return h({queryKey:["massEmailRecipients",n,e,t],queryFn:()=>r.getRecipients(s,e,t),enabled:s.length>0&&!!e})}function p(e,t=!1){var m,y;const{ownerIds:s,filterKey:n}=d(),{data:u}=f(t),i=e?{rules:(m=e.rules)==null?void 0:m.map(a=>({field:a.field,operator:a.operator,value:a.value,value2:a.value2,radius:a.radius})),groups:(y=e.groups)==null?void 0:y.map(a=>{var c;return{rules:(c=a.rules)==null?void 0:c.map(l=>({field:l.field,operator:l.operator,value:l.value,value2:l.value2,radius:l.radius}))}}),search:e.search,notOptedOut:e.notOptedOut,includeRoleAccounts:t}:null;return h({queryKey:["massEmailRecipientStats",n,i,u],queryFn:()=>r.getRecipientStats(u||s,e),enabled:s.length>0&&!!e&&!!u,staleTime:3e4,gcTime:6e4,placeholderData:a=>a})}function B(e,t=!1){const{data:s,isLoading:n,isFetching:u,error:i}=p(e,t);return{data:s==null?void 0:s.count,isLoading:n,isFetching:u,error:i}}function I(e,t=!1){const{data:s,isLoading:n,isFetching:u,error:i}=p(e,t);return{data:s==null?void 0:s.breakdown,isLoading:n,isFetching:u,error:i}}function M(){const{ownerIds:e}=d(),t=v(),s=()=>{t.invalidateQueries({queryKey:["massEmails"]})},n=o({mutationFn:a=>r.create(e,a),onSuccess:s}),u=o({mutationFn:({batchId:a,updates:c})=>r.update(e,a,c),onSuccess:s}),i=o({mutationFn:a=>r.delete(e,a),onSuccess:s}),m=o({mutationFn:({batchId:a,scheduledFor:c})=>r.scheduleBatch(e,a,c),onSuccess:()=>{s(),t.invalidateQueries({queryKey:["scheduledEmails"]})}}),y=o({mutationFn:a=>r.cancelBatch(e,a),onSuccess:()=>{s(),t.invalidateQueries({queryKey:["scheduledEmails"]})}});return{createBatch:n,updateBatch:u,deleteBatch:i,scheduleBatch:m,cancelBatch:y}}export{B as a,K as b,f as c,I as d,M as e,g as u};
