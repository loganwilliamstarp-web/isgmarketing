import{u as v,j as e}from"./query-BgC-0ePs.js";import{e as S,L as h}from"./vendor-CvdBrt7H.js";import"./index-laD0T8Yw.js";import{s as C,u as R,a as k}from"./useDashboard-CXzg9wgv.js";import{u as z}from"./useEffectiveOwner-BN9vJCNM.js";import"./supabase-GtAdROLV.js";import"./accounts-BqGB46ES.js";function $(n=10){const{ownerIds:o,filterKey:i}=z();return v({queryKey:["scheduledEmails",i,"upcoming",n],queryFn:()=>C.getUpcoming(o,n),enabled:o.length>0})}const a=({width:n="100%",height:o="20px"})=>e.jsx("div",{style:{width:n,height:o,backgroundColor:"currentColor",opacity:.1,borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}}),c=({label:n,value:o,change:i,icon:t,positive:x,isLoading:l,theme:d})=>e.jsxs("div",{style:{padding:"20px",backgroundColor:d.bgCard,borderRadius:"12px",border:`1px solid ${d.border}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[e.jsx("span",{style:{color:d.textSecondary,fontSize:"13px"},children:n}),e.jsx("span",{style:{fontSize:"20px"},children:t})]}),l?e.jsx(a,{height:"32px",width:"80px"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:d.text,marginBottom:"4px"},children:o}),i&&e.jsx("span",{style:{fontSize:"12px",color:x?d.success:d.danger},children:i})]})]}),w=({email:n,theme:o,userId:i})=>{var t,x,l;return e.jsx("div",{style:{padding:"14px",backgroundColor:o.bg,borderRadius:"8px",border:`1px solid ${o.border}`},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"11px",color:o.textMuted,marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("span",{children:"ðŸ•"})," ",new Date(n.scheduled_for).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})]}),e.jsx(h,{to:`/${i}/clients/${n.account_id}`,style:{fontSize:"14px",fontWeight:"600",color:o.text,textDecoration:"none"},children:((t=n.accounts)==null?void 0:t.name)||"Unknown Account"}),e.jsx("div",{style:{fontSize:"12px",color:o.textSecondary,marginTop:"2px"},children:((x=n.email_templates)==null?void 0:x.subject)||"No subject"}),e.jsx("span",{style:{display:"inline-block",marginTop:"6px",padding:"3px 8px",backgroundColor:o.bgHover,borderRadius:"4px",fontSize:"11px",color:o.textSecondary},children:((l=n.email_templates)==null?void 0:l.name)||"Unknown Template"})]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[e.jsx("button",{style:{padding:"6px 10px",backgroundColor:o.bgHover,border:`1px solid ${o.border}`,borderRadius:"6px",color:o.textSecondary,cursor:"pointer",fontSize:"12px"},children:"âœˆï¸"}),e.jsx("button",{style:{padding:"6px 10px",backgroundColor:o.bgHover,border:`1px solid ${o.border}`,borderRadius:"6px",color:o.textSecondary,cursor:"pointer",fontSize:"12px"},children:"Ã—"})]})]})})},B=({label:n,you:o,avg:i,theme:t})=>e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"12px",color:t.textSecondary},children:n}),e.jsxs("span",{style:{fontSize:"12px",color:t.textMuted},children:[o,"% vs ",i,"%"]})]}),e.jsxs("div",{style:{display:"flex",gap:"4px",height:"24px"},children:[e.jsx("div",{style:{width:`${Math.min(o,100)}%`,backgroundColor:t.primary,borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"6px",minWidth:"30px"},children:e.jsxs("span",{style:{fontSize:"10px",color:"#fff",fontWeight:"600"},children:[o,"%"]})}),e.jsx("div",{style:{width:`${Math.min(i,100)}%`,backgroundColor:"#14b8a6",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"6px",minWidth:"30px"},children:e.jsxs("span",{style:{fontSize:"10px",color:"#fff",fontWeight:"600"},children:[i,"%"]})})]})]}),A=({t:n})=>{const{userId:o}=S(),{data:i,isLoading:t,error:x}=R(),{data:l,isLoading:d}=$(7),{data:p,isLoading:y}=k(30),u=[{label:"Open Rate",you:(i==null?void 0:i.openRate)||0,avg:32},{label:"Click Rate",you:(i==null?void 0:i.clickRate)||0,avg:8},{label:"Response Rate",you:(i==null?void 0:i.responseRate)||0,avg:5}],g=r=>r>=1e3?`${(r/1e3).toFixed(1)}k`:(r==null?void 0:r.toLocaleString())||"0",m=r=>`${Math.round(r||0)}%`;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:n.text,marginBottom:"4px"},children:"Dashboard"}),e.jsx("p",{style:{color:n.textSecondary,fontSize:"14px",margin:0},children:"Overview of your email campaigns and performance"})]}),x&&e.jsx("div",{style:{padding:"16px",backgroundColor:`${n.danger}15`,border:`1px solid ${n.danger}30`,borderRadius:"8px",marginBottom:"24px",color:n.danger,fontSize:"14px"},children:"Failed to load dashboard data. Please try refreshing the page."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[e.jsx(c,{label:"Emails Sent",value:g(i==null?void 0:i.emailsSent),change:i!=null&&i.emailsSentChange?`${i.emailsSentChange>0?"+":""}${i.emailsSentChange}%`:null,icon:"ðŸ“§",positive:(i==null?void 0:i.emailsSentChange)>0,isLoading:t,theme:n}),e.jsx(c,{label:"Open Rate",value:m(i==null?void 0:i.openRate),change:i!=null&&i.openRateChange?`${i.openRateChange>0?"+":""}${i.openRateChange}%`:null,icon:"ðŸ“¬",positive:(i==null?void 0:i.openRateChange)>0,isLoading:t,theme:n}),e.jsx(c,{label:"Click Rate",value:m(i==null?void 0:i.clickRate),change:i!=null&&i.clickRateChange?`${i.clickRateChange>0?"+":""}${i.clickRateChange}%`:null,icon:"ðŸ–±ï¸",positive:(i==null?void 0:i.clickRateChange)>0,isLoading:t,theme:n}),e.jsx(c,{label:"Scheduled",value:g(i==null?void 0:i.scheduledCount),change:null,icon:"ðŸ“…",positive:null,isLoading:t,theme:n})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{padding:"20px",backgroundColor:n.bgCard,borderRadius:"12px",border:`1px solid ${n.border}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:n.text,margin:0},children:"Upcoming Scheduled Emails"}),e.jsx(h,{to:`/${o}/scheduled`,style:{fontSize:"12px",color:n.primary,textDecoration:"none"},children:"View all â†’"})]}),e.jsx("p",{style:{fontSize:"12px",color:n.textSecondary,marginBottom:"16px"},children:"Emails scheduled to be sent in the next 7 days"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:d?Array.from({length:3}).map((r,s)=>e.jsxs("div",{style:{padding:"14px",backgroundColor:n.bg,borderRadius:"8px",border:`1px solid ${n.border}`},children:[e.jsx(a,{height:"12px",width:"120px"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(a,{height:"16px",width:"180px"})}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(a,{height:"12px",width:"220px"})})]},s)):(l==null?void 0:l.length)>0?l.slice(0,5).map(r=>e.jsx(w,{email:r,theme:n,userId:o},r.id)):e.jsxs("div",{style:{padding:"40px 20px",textAlign:"center",color:n.textMuted,fontSize:"14px"},children:[e.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"ðŸ“­"}),"No scheduled emails in the next 7 days"]})})]}),e.jsxs("div",{style:{padding:"20px",backgroundColor:n.bgCard,borderRadius:"12px",border:`1px solid ${n.border}`},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:n.text,marginBottom:"4px"},children:"Performance Comparison"}),e.jsx("p",{style:{fontSize:"12px",color:n.textSecondary,marginBottom:"16px"},children:"Your metrics compared to industry averages"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:t?Array.from({length:3}).map((r,s)=>e.jsxs("div",{children:[e.jsx(a,{height:"12px",width:"100px"}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(a,{height:"24px"})})]},s)):u.map((r,s)=>e.jsx(B,{label:r.label,you:r.you,avg:r.avg,theme:n},s))}),e.jsxs("div",{style:{display:"flex",gap:"16px",marginTop:"16px",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"12px",height:"12px",backgroundColor:n.primary,borderRadius:"2px"}}),e.jsx("span",{style:{fontSize:"11px",color:n.textSecondary},children:"You"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("div",{style:{width:"12px",height:"12px",backgroundColor:"#14b8a6",borderRadius:"2px"}}),e.jsx("span",{style:{fontSize:"11px",color:n.textSecondary},children:"Industry Avg"})]})]})]})]}),e.jsxs("div",{style:{marginTop:"20px",padding:"20px",backgroundColor:n.bgCard,borderRadius:"12px",border:`1px solid ${n.border}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:n.text,margin:0},children:"Recent Email Activity"}),e.jsx(h,{to:`/${o}/activity`,style:{fontSize:"12px",color:n.primary,textDecoration:"none"},children:"View all â†’"})]}),y?e.jsx(a,{height:"200px"}):(p==null?void 0:p.length)>0?e.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:"4px",height:"200px",padding:"20px 0"},children:p.slice(-14).map((r,s)=>{const f=Math.max(...p.map(b=>b.sent||0),1),j=(r.sent||0)/f*150;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[e.jsx("div",{style:{width:"100%",height:`${j}px`,backgroundColor:n.primary,borderRadius:"4px 4px 0 0",minHeight:"4px"},title:`${r.sent||0} sent on ${r.date}`}),e.jsx("span",{style:{fontSize:"9px",color:n.textMuted},children:new Date(r.date).toLocaleDateString("en-US",{weekday:"short"}).charAt(0)})]},s)})}):e.jsx("div",{style:{padding:"40px 20px",textAlign:"center",color:n.textMuted,fontSize:"14px"},children:"No email activity data yet"})]})]})};export{A as default};
